{"version":3,"names":[],"mappings":"","sources":["app.min.js"],"sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n(function () {\n\n    var laroute = (function () {\n\n        var routes = {\n\n            absolute: false,\n            rootUrl: 'http:127.0.0.1',\n            routes : [{\"host\":null,\"methods\":[\"GET\",\"HEAD\"],\"uri\":\"admin\",\"name\":\"admin.index\",\"action\":\"App\\Http\\Controllers\\Admin\\AdminController@index\"},{\"host\":null,\"methods\":[\"GET\",\"HEAD\"],\"uri\":\"index-admin\",\"name\":\"auth.index-admin\",\"action\":\"App\\Http\\Controllers\\Admin\\AdminController@indexAdmin\"},{\"host\":null,\"methods\":[\"GET\",\"HEAD\"],\"uri\":\"auth-google\\/{auth?}\",\"name\":\"auth-google\",\"action\":\"App\\Http\\Controllers\\Admin\\AssistenceController@getGoogleLogin\"},{\"host\":null,\"methods\":[\"GET\",\"HEAD\"],\"uri\":\"assistence\",\"name\":\"assistence.index\",\"action\":\"App\\Http\\Controllers\\Admin\\AssistenceController@index\"},{\"host\":null,\"methods\":[\"GET\",\"HEAD\"],\"uri\":\"assistence\\/create\",\"name\":\"assistence.create\",\"action\":\"App\\Http\\Controllers\\Admin\\AssistenceController@create\"},{\"host\":null,\"methods\":[\"POST\"],\"uri\":\"assistence\",\"name\":\"assistence.store\",\"action\":\"App\\Http\\Controllers\\Admin\\AssistenceController@store\"},{\"host\":null,\"methods\":[\"GET\",\"HEAD\"],\"uri\":\"assistence\\/{assistence}\",\"name\":\"assistence.show\",\"action\":\"App\\Http\\Controllers\\Admin\\AssistenceController@show\"},{\"host\":null,\"methods\":[\"GET\",\"HEAD\"],\"uri\":\"assistence\\/{assistence}\\/edit\",\"name\":\"assistence.edit\",\"action\":\"App\\Http\\Controllers\\Admin\\AssistenceController@edit\"},{\"host\":null,\"methods\":[\"PUT\",\"PATCH\"],\"uri\":\"assistence\\/{assistence}\",\"name\":\"assistence.update\",\"action\":\"App\\Http\\Controllers\\Admin\\AssistenceController@update\"},{\"host\":null,\"methods\":[\"DELETE\"],\"uri\":\"assistence\\/{assistence}\",\"name\":\"assistence.destroy\",\"action\":\"App\\Http\\Controllers\\Admin\\AssistenceController@destroy\"},{\"host\":null,\"methods\":[\"GET\",\"HEAD\"],\"uri\":\"assistences\\/logout-google\",\"name\":\"logout-google\",\"action\":\"App\\Http\\Controllers\\Admin\\AssistenceController@getGoogleLogout\"},{\"host\":null,\"methods\":[\"GET\",\"HEAD\"],\"uri\":\"type-product\",\"name\":\"type-product.index\",\"action\":\"App\\Http\\Controllers\\App\\TypeProductController@index\"},{\"host\":null,\"methods\":[\"GET\",\"HEAD\"],\"uri\":\"type-product\\/create\",\"name\":\"type-product.create\",\"action\":\"App\\Http\\Controllers\\App\\TypeProductController@create\"},{\"host\":null,\"methods\":[\"POST\"],\"uri\":\"type-product\",\"name\":\"type-product.store\",\"action\":\"App\\Http\\Controllers\\App\\TypeProductController@store\"},{\"host\":null,\"methods\":[\"GET\",\"HEAD\"],\"uri\":\"type-product\\/{type_product}\",\"name\":\"type-product.show\",\"action\":\"App\\Http\\Controllers\\App\\TypeProductController@show\"},{\"host\":null,\"methods\":[\"GET\",\"HEAD\"],\"uri\":\"type-product\\/{type_product}\\/edit\",\"name\":\"type-product.edit\",\"action\":\"App\\Http\\Controllers\\App\\TypeProductController@edit\"},{\"host\":null,\"methods\":[\"PUT\",\"PATCH\"],\"uri\":\"type-product\\/{type_product}\",\"name\":\"type-product.update\",\"action\":\"App\\Http\\Controllers\\App\\TypeProductController@update\"},{\"host\":null,\"methods\":[\"DELETE\"],\"uri\":\"type-product\\/{type_product}\",\"name\":\"type-product.destroy\",\"action\":\"App\\Http\\Controllers\\App\\TypeProductController@destroy\"},{\"host\":null,\"methods\":[\"GET\",\"HEAD\"],\"uri\":\"brands-attended\",\"name\":\"brands-attended.index\",\"action\":\"App\\Http\\Controllers\\App\\BrandsAttendedController@index\"},{\"host\":null,\"methods\":[\"GET\",\"HEAD\"],\"uri\":\"brands-attended\\/create\",\"name\":\"brands-attended.create\",\"action\":\"App\\Http\\Controllers\\App\\BrandsAttendedController@create\"},{\"host\":null,\"methods\":[\"POST\"],\"uri\":\"brands-attended\",\"name\":\"brands-attended.store\",\"action\":\"App\\Http\\Controllers\\App\\BrandsAttendedController@store\"},{\"host\":null,\"methods\":[\"GET\",\"HEAD\"],\"uri\":\"brands-attended\\/{brands_attended}\",\"name\":\"brands-attended.show\",\"action\":\"App\\Http\\Controllers\\App\\BrandsAttendedController@show\"},{\"host\":null,\"methods\":[\"GET\",\"HEAD\"],\"uri\":\"brands-attended\\/{brands_attended}\\/edit\",\"name\":\"brands-attended.edit\",\"action\":\"App\\Http\\Controllers\\App\\BrandsAttendedController@edit\"},{\"host\":null,\"methods\":[\"PUT\",\"PATCH\"],\"uri\":\"brands-attended\\/{brands_attended}\",\"name\":\"brands-attended.update\",\"action\":\"App\\Http\\Controllers\\App\\BrandsAttendedController@update\"},{\"host\":null,\"methods\":[\"DELETE\"],\"uri\":\"brands-attended\\/{brands_attended}\",\"name\":\"brands-attended.destroy\",\"action\":\"App\\Http\\Controllers\\App\\BrandsAttendedController@destroy\"},{\"host\":null,\"methods\":[\"GET\",\"HEAD\"],\"uri\":\"assistence-request\",\"name\":\"assistence-request.index\",\"action\":\"App\\Http\\Controllers\\Admin\\AssistenceRequestController@index\"},{\"host\":null,\"methods\":[\"GET\",\"HEAD\"],\"uri\":\"assistence-request\\/{assistence_request}\",\"name\":\"assistence-request.show\",\"action\":\"App\\Http\\Controllers\\Admin\\AssistenceRequestController@show\"},{\"host\":null,\"methods\":[\"GET\",\"HEAD\"],\"uri\":\"assistence-request\\/{assistence_request}\\/edit\",\"name\":\"assistence-request.edit\",\"action\":\"App\\Http\\Controllers\\Admin\\AssistenceRequestController@edit\"},{\"host\":null,\"methods\":[\"PUT\",\"PATCH\"],\"uri\":\"assistence-request\\/{assistence_request}\",\"name\":\"assistence-request.update\",\"action\":\"App\\Http\\Controllers\\Admin\\AssistenceRequestController@update\"},{\"host\":null,\"methods\":[\"DELETE\"],\"uri\":\"assistence-request\\/{assistence_request}\",\"name\":\"assistence-request.destroy\",\"action\":\"App\\Http\\Controllers\\Admin\\AssistenceRequestController@destroy\"},{\"host\":null,\"methods\":[\"GET\",\"HEAD\"],\"uri\":\"search-assistence\",\"name\":\"search-assistence.index\",\"action\":\"App\\Http\\Controllers\\App\\AssistenceController@index\"},{\"host\":null,\"methods\":[\"POST\"],\"uri\":\"search-assistence\",\"name\":\"search-assistence.store\",\"action\":\"App\\Http\\Controllers\\App\\AssistenceController@store\"},{\"host\":null,\"methods\":[\"GET\",\"HEAD\"],\"uri\":\"search-assistence\\/{search_assistence}\",\"name\":\"search-assistence.show\",\"action\":\"App\\Http\\Controllers\\App\\AssistenceController@show\"},{\"host\":null,\"methods\":[\"GET\",\"HEAD\"],\"uri\":\"assistence-solicitation\",\"name\":\"assistence-solicitation.create\",\"action\":\"App\\Http\\Controllers\\App\\AssistenceRequestController@create\"},{\"host\":null,\"methods\":[\"POST\"],\"uri\":\"assistence-solicitation\",\"name\":\"assistence-solicitation.store\",\"action\":\"App\\Http\\Controllers\\App\\AssistenceRequestController@store\"},{\"host\":null,\"methods\":[\"GET\",\"HEAD\"],\"uri\":\"index\",\"name\":\"index\",\"action\":\"App\\Http\\Controllers\\Auth\\AuthController@index\"},{\"host\":null,\"methods\":[\"GET\",\"HEAD\"],\"uri\":\"\\/\",\"name\":\"index\",\"action\":\"App\\Http\\Controllers\\Auth\\AuthController@index\"},{\"host\":null,\"methods\":[\"GET\",\"HEAD\"],\"uri\":\"login\",\"name\":\"auth.login\",\"action\":\"App\\Http\\Controllers\\Auth\\AuthController@login\"},{\"host\":null,\"methods\":[\"POST\"],\"uri\":\"login\",\"name\":\"auth.authenticate\",\"action\":\"App\\Http\\Controllers\\Auth\\AuthController@authenticate\"},{\"host\":null,\"methods\":[\"GET\",\"HEAD\"],\"uri\":\"logout\",\"name\":\"auth.logout\",\"action\":\"App\\Http\\Controllers\\Auth\\AuthController@logout\"}],\n            prefix: '',\n\n            route : function (name, parameters, route) {\n                route = route || this.getByName(name);\n\n                if ( ! route ) {\n                    return undefined;\n                }\n\n                return this.toRoute(route, parameters);\n            },\n\n            url: function (url, parameters) {\n                parameters = parameters || [];\n\n                var uri = url + '/' + parameters.join('/');\n\n                return this.getCorrectUrl(uri);\n            },\n\n            toRoute : function (route, parameters) {\n                var uri = this.replaceNamedParameters(route.uri, parameters);\n                var qs  = this.getRouteQueryString(parameters);\n\n                return this.getCorrectUrl(uri + qs);\n            },\n\n            replaceNamedParameters : function (uri, parameters) {\n                uri = uri.replace(/\\{(.*?)\\??\\}/g, function(match, key) {\n                    if (parameters.hasOwnProperty(key)) {\n                        var value = parameters[key];\n                        delete parameters[key];\n                        return value;\n                    } else {\n                        return match;\n                    }\n                });\n\n                // Strip out any optional parameters that were not given\n                uri = uri.replace(/\\/\\{.*?\\?\\}/g, '');\n\n                return uri;\n            },\n\n            getRouteQueryString : function (parameters) {\n                var qs = [];\n                for (var key in parameters) {\n                    if (parameters.hasOwnProperty(key)) {\n                        qs.push(key + '=' + parameters[key]);\n                    }\n                }\n\n                if (qs.length < 1) {\n                    return '';\n                }\n\n                return '?' + qs.join('&');\n            },\n\n            getByName : function (name) {\n                for (var key in this.routes) {\n                    if (this.routes.hasOwnProperty(key) && this.routes[key].name === name) {\n                        return this.routes[key];\n                    }\n                }\n            },\n\n            getByAction : function(action) {\n                for (var key in this.routes) {\n                    if (this.routes.hasOwnProperty(key) && this.routes[key].action === action) {\n                        return this.routes[key];\n                    }\n                }\n            },\n\n            getCorrectUrl: function (uri) {\n                var url = this.prefix + '/' + uri.replace(/^\\/?/, '');\n\n                if(!this.absolute)\n                    return url;\n\n                return this.rootUrl.replace('/\\/?$/', '') + url;\n            }\n        };\n\n        var getLinkAttributes = function(attributes) {\n            if ( ! attributes) {\n                return '';\n            }\n\n            var attrs = [];\n            for (var key in attributes) {\n                if (attributes.hasOwnProperty(key)) {\n                    attrs.push(key + '=\"' + attributes[key] + '\"');\n                }\n            }\n\n            return attrs.join(' ');\n        };\n\n        var getHtmlLink = function (url, title, attributes) {\n            title      = title || url;\n            attributes = getLinkAttributes(attributes);\n\n            return '<a href=\"' + url + '\" ' + attributes + '>' + title + '</a>';\n        };\n\n        return {\n            // Generate a url for a given controller action.\n            // laroute.action('HomeController@getIndex', [params = {}])\n            action : function (name, parameters) {\n                parameters = parameters || {};\n\n                return routes.route(name, parameters, routes.getByAction(name));\n            },\n\n            // Generate a url for a given named route.\n            // laroute.route('routeName', [params = {}])\n            route : function (route, parameters) {\n                parameters = parameters || {};\n\n                return routes.route(route, parameters);\n            },\n\n            // Generate a fully qualified URL to the given path.\n            // laroute.route('url', [params = {}])\n            url : function (route, parameters) {\n                parameters = parameters || {};\n\n                return routes.url(route, parameters);\n            },\n\n            // Generate a html link to the given url.\n            // laroute.link_to('foo/bar', [title = url], [attributes = {}])\n            link_to : function (url, title, attributes) {\n                url = this.url(url);\n\n                return getHtmlLink(url, title, attributes);\n            },\n\n            // Generate a html link to the given route.\n            // laroute.link_to_route('route.name', [title=url], [parameters = {}], [attributes = {}])\n            link_to_route : function (route, title, parameters, attributes) {\n                var url = this.route(route, parameters);\n\n                return getHtmlLink(url, title, attributes);\n            },\n\n            // Generate a html link to the given controller action.\n            // laroute.link_to_action('HomeController@getIndex', [title=url], [parameters = {}], [attributes = {}])\n            link_to_action : function(action, title, parameters, attributes) {\n                var url = this.action(action, parameters);\n\n                return getHtmlLink(url, title, attributes);\n            }\n\n        };\n\n    }).call(this);\n\n    /**\n     * Expose the class either via AMD, CommonJS or the global object\n     */\n    if (typeof define === 'function' && define.amd) {\n        define(function () {\n            return laroute;\n        });\n    }\n    else if (typeof module === 'object' && module.exports){\n        module.exports = laroute;\n    }\n    else {\n        window.laroute = laroute;\n    }\n\n}).call(this);\n\n\n},{}],2:[function(require,module,exports){\n//functions\nvar Mapa = require('./functions/Mapa.js');\n\n//Events\nvar StartApplication = require('./events/StartApplication.js');\nrequire('./events/openModal.js');\nrequire('./events/deleteConfirmation.js');\n\n$.material.init();\n\nMapa.init();\n\nStartApplication();\n$(document).on('needs-application-restart', function(e) {\n  StartApplication();\n});\n\n},{\"./events/StartApplication.js\":3,\"./events/deleteConfirmation.js\":4,\"./events/openModal.js\":5,\"./functions/Mapa.js\":6}],3:[function(require,module,exports){\n//helpers\nvar dataTablesConfig = require('../helpers/dataTablesConfig.js');\n\n//functions\nvar makeSelectizeOnEach = require('../functions/makeSelectizeOnEach.js');\nvar makeDataTableOnEach = require('../functions/makeDataTableOnEach.js');\n\n//events\n\nfunction StartApplication() {\n  makeSelectizeOnEach();\n  makeDataTableOnEach();\n\n  \t//Função para deletar assistencia após aprovala e inseri-la no fusion tables\n\t$('[data-aprove-delete]').one(\"click\", function(e) {\n\t\tvar target = e.target;\n\t  \t//e.preventDefault();\n\t  \t//e.stopPropagation();\n\t  \tvar form = $(target).closest('form');\n\n\t\tvar url = $(target).data('aprove-delete');\n\t\t\n\t  \t$.ajax({\n\t      \turl: url,\n\t      \tdata: form.serialize(),\n\t      \tmethod: \"DELETE\",\n\t      \tsuccess: function(data) {\n\t      \t\tconsole.log('foi');\n\t      \t}\n    \t});\n\n\t});\n\n \t$('#hoursStart').timepicki();\n \t$('#hoursEnd').timepicki();\n}\n\n//$.extend($.fn.dataTable.defaults, dataTablesConfig($('meta[name=locale]').prop('content')));\n$.extend($.fn.dataTable.defaults, dataTablesConfig);\nmodule.exports = StartApplication;\n\n\n},{\"../functions/makeDataTableOnEach.js\":8,\"../functions/makeSelectizeOnEach.js\":9,\"../helpers/dataTablesConfig.js\":10}],4:[function(require,module,exports){\n//funcção para exibir modal de deletar\n$(document).on(\"click\", \"button[data-id]\", function(e) {\n  e.preventDefault();\n  e.stopPropagation();\n  var $button = $(e.target);\n  $button = $button[0].localName === 'button' ? $button : $button.closest('button[data-id]');\n\n  var submitForm = function() {\n\n    var form = 'form[data-id=' + $button.data('id') + ']';\n    var $form = $button.closest(form);\n    $form.submit();\n  };\n\n  $('#modal-delete')\n    .find('.btn-delete')\n    .one(\"click\", submitForm);\n\n  $('#modal-delete').modal('show');\n});\n\n},{}],5:[function(require,module,exports){\n//função para abrir modal\n$(document).on(\"click\", \"a[data-modal-open]\", function(e) {\n  var target = e.target;\n  var button = target.tagName.toLowerCase() == 'a' ? $(target) : $(target).closest('a');\n\n  e.preventDefault();\n  e.stopPropagation();\n\n  $(button.data('target') + ' .modal-dialog').load(button.data('href'), function() {\n    $(button.data('target')).modal('show');\n    $(document).trigger('needs-application-restart');\n  });\n\n});\n\n},{}],6:[function(require,module,exports){\nvar laroute = require('../../laroute.js');\nvar getUrlVars = require('../functions/getUrlVars.js');\n\nexports.init = function() {\n  \n  var tableId = '1aPLJfYAPlL3L2KVVC-FyZaspqnpv4MWK-dYpgbPS';\n\n  window.initMap = function() {\n    latlng = new google.maps.LatLng(-20.642921,-47.225273); //minha casa\n    //console.log(JSON.stringify(latlng));\n    map = new google.maps.Map(document.getElementById('map'), {\n      center: latlng,\n      zoom: 16\n    });\n    //directionsDisplay.setMap(map);\n\n\n    if(window.location.search) {\n      //alert('loco');\n      var rowid = getUrlVars()['assistence'];\n      query = 'rowid=' + rowid;\n\n      url = laroute.route('search-assistence.show', {\n        search_assistence: rowid, map: true\n      });   \n      $.ajax({\n        method: 'GET',\n        url: url,\n        success: function(data) {\n\n          var geocoder = new google.maps.Geocoder();\n          var address = data.Location;\n          geocoder.geocode({'address': address}, function(results, status) {\n            if (status === google.maps.GeocoderStatus.OK) {\n              map.setCenter(results[0].geometry.location);\n              map.setZoom(15);\n            } else {\n              alert('Geocode was not successful for the following reason: ' + status);\n            }\n          });\n        }\n      });\n      //map = new google.maps.Map(document.getElementById('map'));\n      //camada  do fusion table\n      var layer = new google.maps.FusionTablesLayer({\n        query: {\n          select: '\\'Location\\'',\n          from: tableId,\n          where: query\n        },\n        styles: [{\n            where: 'category like \\'AUTORIZADA\\'',\n            markerOptions: {\n              iconName: \"ylw_stars\",\n              zIndex:100\n            }\n          }, {\n            where: 'category like \\'ESPECIALIZADA\\'',\n            markerOptions: {\n              iconName: \"wht_blank\",\n              zIndex:99\n            }\n          }\n        ],\n        suppressInfoWindows: true\n        //map: map\n      });\n\n      layer.setMap(map);\n      //console.log(layer);\n      google.maps.event.addListener(layer, 'click', function(e) {\n        //e.infoWindowHtml = \"\";\n        var end = e.row['Location'].value;\n        var url = laroute.route('search-assistence.store');\n        var urlBtn;\n\n        if(typeof infowindows != \"undefined\") {\n          infowindows.setMap(null);\n        }\n        $.ajax({\n          method: 'POST',\n          url: url,\n          data: {\n            'Location': end\n          },\n          success: function(data) {\n            urlBtn = laroute.route('search-assistence.show', {\n              search_assistence: data.rowid\n            });\n\n            infowindows = new google.maps.InfoWindow();\n        \n            infowindows.setContent(\"<strong>Nome: </strong>\" + e.row['name'].value + \"<br>\"\n              + \"<strong>Endereço: </strong>\" + e.row['Location'].value + \"<br>\"\n              + \"<strong>Telefone: </strong>\" + e.row['fone'].value + \"<br>\"\n              + '<a onclick=\"calcRoute( &apos;' + end\n              + '&apos;)\" id=\"makeRoute\" class=\"btn btn-success btn-sm\" title=\"Traçar rota\">Como chegar</a>'\n              + '<a data-href=\"' + urlBtn + '\" class=\"btn btn-info btn-xs\" data-target=\"#show-assistence-modal\"'\n              + 'href=\"\" data-modal-open=\"\">'\n              + '<i class=\"fa fa-search\"></i> Ver Assistência </a>'\n            );\n              //+ \"Horario de funcionamento:\" + e.row['BusinessHoursDate'].value + \"<br>\"\n            infowindows.setPosition(e.latLng);\n            infowindows.open(map);\n          }\n        });\n      });\n\n    } else {\n      //obtem localização do usuario e centraliza mapa nela\n      if (navigator.geolocation) {\n        navigator.geolocation.getCurrentPosition(function(position) {\n          //se achou o local e o navegador suporta\n          var pos = { lat: position.coords.latitude, lng: position.coords.longitude };\n          var $address = $('#address');\n          //Atribui localização encontrada ao input de onde pesquisar\n          geocoder = new google.maps.Geocoder;\n          geocoder.geocode({'location': pos}, function(results, status) {\n            if (status === google.maps.GeocoderStatus.OK) {\n              if (results[1]) {\n                $address.val(results[1].formatted_address);\n                //console.log(results[1], results[1].address_components);\n                getEverythingAroundMe();\n              } else {\n                console.log('Local não encontrado!');\n              }\n            } else {\n              console.log('Geocoder failed due to: ' + status);\n            }\n          });\n\n          //centraliza mapa na posição encontrada\n          map.setCenter(pos);\n\n        }, function() {\n          // se não encontrou a localização de nois\n          console.log('Geolocation não autorizado ou com problemas');\n        });\n      } else {\n        // Browser doesn't support Geolocation\n        console.log('Navegador não suporta Geolocation');\n      }\n    }\n\n  }\n\n  // Buscar todas as Assistências Na posição encontrada do user\n  function getEverythingAroundMe() {\n    if (navigator.geolocation) {\n      navigator.geolocation.getCurrentPosition(function(position) {\n        //se achou o local e o navegador suporta\n        var pos = {\n          lat: position.coords.latitude,\n          lng: position.coords.longitude\n        };\n\n        //limpa tudo os trem antes de marcar os locais\n        clearMap();\n\n        //pesquisa todos os locais em volta..\n        markPlacesFromTables(pos);\n\n      }, function() {\n        // se não encontrou a localização de nois\n        console.log('Geolocation não altorizado ou com problemas');\n      });\n    } else {\n      // Browser doesn't support Geolocation\n      console.log('Navegador não suporta Geolocation');\n    } \n  }\n\n//Busca tudo ao redor\n$('#js-everythingAroundMe').on('click', function() {\n  getEverythingAroundMe();\n});\n\n  var $form = $(\"#form-busca\");\n  $form.submit(function(e) {\n    e.preventDefault();\n\n    var address = $('#address').val();\n    var radius = $('#radius').val() * 1000;\n    var category = $('#category').val();\n    var typeProduct = $('#typeProduct').val();\n    var brandsAttended = $('#brandsAttended').val();\n    geocoder = new google.maps.Geocoder;\n    geocoder.geocode( { 'address': address}, function(results, status) {\n      if (status == google.maps.GeocoderStatus.OK) {\n        var pos = JSON.stringify(results[0].geometry.location);\n        pos = JSON.parse(pos);\n\n        clearMap();\n        //pesquisa os locais em volta..\n        markPlacesFromTables(pos, category, typeProduct, brandsAttended, parseInt(radius));\n\n      } else {\n        console.log(\"Geocode was not successful for the following reason: \" + status);\n      }\n    \n    });\n  });\n\n  //limpa todos os trem do mapa\n  function clearMap() {\n    //google.maps.event.trigger(map, 'resize');\n    if(typeof circle != \"undefined\") { \n      circle.setMap(null);\n    }\n    //console.log(typeof layer);\n    if(typeof layer != \"undefined\") { \n      //delete layer;\n      layer.setMap(null);\n    }\n    if(typeof markerMyLocation != \"undefined\") {  \n      markerMyLocation.setMap(null);\n    }\n\n    if(typeof directionsDisplay != \"undefined\") {\n      directionsDisplay.setMap(null);\n    }\n  }\n\n  //marca e centraliza o usuario com a posição dada.\n  function tagMe(myLocation) {\n\n    map.setCenter(myLocation);\n    map.setZoom(14);\n    //fazer if para descobrir melhor zoom dependendo da area de cobertura\n\n    var image = 'https://cdn4.iconfinder.com/data/icons/map1/502/Untitled-11-48.png';\n    markerMyLocation = new google.maps.Marker({\n        map: map,\n        position: myLocation,\n        title: 'Minha Localização',\n        icon: image,\n        draggable: true\n    });\n\n    google.maps.event.addListener(markerMyLocation, 'click', function() {\n      infowindow = new google.maps.InfoWindow();\n      infowindow.setContent('Minha Localização');\n      infowindow.open(map, this);\n    });  \n  }\n\n  function markPlacesFromTables(\n      myLocation,\n      category = null,\n      typeProduct = null,\n      brandsAttended = null,\n      radius = 50000\n    )\n  {    \n    \n    var searchCategory = category ? 'category like \\'' + category + '\\' and ' : '';\n    var searchTypeProduct = typeProduct ? 'typeProduct like \\'%' + typeProduct + '%\\' and ' : '';\n    var searchBrandsAttended = brandsAttended ? 'brandsAttended like \\'%' + brandsAttended + '%\\' and ' : '';\n    //console.log(searchCategory, searchTypeProduct, searchBrandsAttended);\n\n    map = new google.maps.Map(document.getElementById('map'));\n\n    //Cria o circulo azul mostrando a abrangencia da pesquisa\n    circle = new google.maps.Circle({\n      strokeColor: '#0000ff',\n      strokeOpacity: 0.4,\n      strokeWeight: 1,\n      fillColor: '#0000ff',\n      fillOpacity: 0.07,\n      map: map,\n      center: myLocation, \n      radius: radius\n    });\n\n    //camada  do fusion table\n    var layer = new google.maps.FusionTablesLayer({\n      query: {\n        select: '\\'Location\\'',\n        from: tableId,\n        where:\n          searchCategory +\n          searchTypeProduct +\n          searchBrandsAttended +\n          ' ST_INTERSECTS(Location, CIRCLE(LATLNG('+\n            myLocation.lat + ',' + myLocation.lng + '), ' + radius +\n          '))'          \n      },\n      styles: [{\n          where: 'category like \\'AUTORIZADA\\'',\n          markerOptions: {\n            iconName: \"ylw_stars\",\n            zIndex:100\n          }\n        }, {\n          where: 'category like \\'ESPECIALIZADA\\'',\n          markerOptions: {\n            iconName: \"wht_blank\",\n            zIndex:99\n          }\n        }\n      ],\n      suppressInfoWindows: true,\n      map: map\n    });\n\n    google.maps.event.addListener(circle, 'mouseover', function(e) {\n      circle.setVisible(false);\n    });\n\n    google.maps.event.addListener(map, 'mouseout', function(e) {\n\n      circle.setVisible(true);\n      //circle.setMap(map);\n    });\n\n    google.maps.event.addListener(layer, 'click', function(e) {\n      //e.infoWindowHtml = \"\";\n      var end = e.row['Location'].value;\n      var url = laroute.route('search-assistence.store');\n      var urlBtn;\n\n      if(typeof infowindows != \"undefined\") {\n        infowindows.setMap(null);\n      }\n      $.ajax({\n        method: 'POST',\n        url: url,\n        data: {\n          'Location': end\n        },\n        success: function(data) {\n          urlBtn = laroute.route('search-assistence.show', {\n            search_assistence: data.rowid\n          });\n\n          infowindows = new google.maps.InfoWindow();\n          infowindows.setContent(\"<p class='text-2x'>\" + e.row['name'].value + \"</p> <br>\"\n            + e.row['category'].value + \"<br>\"\n            + \"<strong>\" + e.row['Location'].value + \"</strong><br>\"\n            + \"<strong>Fone: </strong>\" + e.row['fone'].value + \"<br>\"\n            + '<a onclick=\"calcRoute( &apos;' + end\n            + '&apos;)\" id=\"makeRoute\" class=\"btn btn-success btn-sm\" title=\"Traçar rota\">Como chegar</a>'\n            + '<a data-href=\"' + urlBtn + '\" class=\"btn btn-info btn-xs\" data-target=\"#show-assistence-modal\"'\n            + 'href=\"\" data-modal-open=\"\">'\n            + '<i class=\"fa fa-search\"></i> Ver Assistência </a>'\n          );\n            //+ \"Horario de funcionamento:\" + e.row['BusinessHoursDate'].value + \"<br>\"\n          infowindows.setPosition(e.latLng);\n          infowindows.open(map);\n        }\n      });\n    });\n      \n    //marcar posição do user.\n    tagMe(myLocation);\n\n  }\n\n  window.calcRoute = function(end) {\n    rendererOptions = {\n      //draggable: true\n    };\n    directionsDisplay = new google.maps.DirectionsRenderer(rendererOptions);\n    directionsService = new google.maps.DirectionsService();\n\n    directionsDisplay.setMap(map);\n    var enderecoPartida = markerMyLocation.getPosition();\n    //var enderecoPartida = $('#address').val();\n    var enderecoChegada = end;\n\n    var request = {\n      origin: enderecoPartida,\n      destination: enderecoChegada,\n      travelMode: google.maps.TravelMode.DRIVING,\n      provideRouteAlternatives: true // ativar rotas alternativas\n    };\n\n    directionsService.route(request, function(response, status) {\n      if (status == google.maps.DirectionsStatus.OK) {\n      directionsDisplay.setDirections(response);\n      calculos(response);\n      }\n    });\n  }\n\n  function calculos(result) {\n    //console.log(result);\n    //return;\n    var consumoVeiculo = 10; //carro\n    var consumoMoto = 27; //carro\n    var valorCombustivel = 3.60; // gasolina\n    var valorCombustivelAlcool = 2.60; // alcool\n    var distanciaKm = 0;\n    var segundos = 0;\n    var horas = 0;\n    var minutos = 0;\n    var myroute = result.routes[0];\n    var litrosKm = 0;\n    var custoViagem = 0;\n    var enderecoPartidaFormatado;\n    var enderecoPartidaFormatado;\n    \n    for (var i = 0; i < myroute.legs.length; i++) {\n      distanciaKm += myroute.legs[i].distance.value; // recebo a distancia em Metros\n      segundos += myroute.legs[i].duration.value; // recebo a duraçao em Segundos\n      //enderecoPartidaFormatado = myroute.legs[i].start_address; // recebo as informaçoes de endereço do ponto \"A\"\n      //enderecoChegadaFormatado = myroute.legs[i].end_address; // recebo as informaçoes de endereço do ponto \"B\" \n    }\n    \n    \n    // calculo da Rota de segundos para hora e minuto\n    horas = segundos / 3600;\n    horas = Math.floor(horas);\n    segundos -= horas * 3600;\n    minutos = segundos / 60;\n    minutos = minutos.toFixed(); \n    segundos -= minutos * 60;\n    segundos = segundos.toFixed();\n    tempo = horas ? horas + ' horas e  ' : '';\n    tempo += minutos +' minutos';\n    //document.getElementById('tempo').innerHTML = '<b>Tempo estimado: </b>' + horas + ' horas e  ' + minutos +' minutos';\n    \n    //distancia/km\n    distanciaKm = distanciaKm / 1000.0;\n    distanciaKm = distanciaKm.toFixed(1);\n    //document.getElementById('distanciaKm').innerHTML = '<b>Distancia: </b>' + distanciaKm + ' km';\n    \n    // Consumo da viagem\n    litrosKm = distanciaKm / consumoVeiculo;\n    custoViagem = litrosKm * valorCombustivel;\n    custoViagem = custoViagem.toFixed(2);\n    //document.getElementById('custo').innerHTML = '<b>Custo da Viagem (R$): </b>' + custoViagem;\n\n    infowindowCusto = new google.maps.InfoWindow();\n    infowindowCusto.setContent('<strong>Tempo estimado: </strong>' + tempo\n      + '<br/>' + '<strong>Distancia: </strong>' + distanciaKm + ' km'\n      + '<br/>' + '<strong>Custo da Viagem R$: </strong>' + custoViagem\n    );\n    infowindowCusto.setPosition(markerMyLocation.getPosition());\n    infowindowCusto.open(map);\n\n  }\n}\n\n},{\"../../laroute.js\":1,\"../functions/getUrlVars.js\":7}],7:[function(require,module,exports){\nfunction getUrlVars()\n{\n    var vars = [], hash;\n    var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');\n    for(var i = 0; i < hashes.length; i++)\n    {\n        hash = hashes[i].split('=');\n        vars.push(hash[0]);\n        vars[hash[0]] = hash[1];\n    }\n    return vars;\n}\nmodule.exports = getUrlVars;\n\n},{}],8:[function(require,module,exports){\nfunction makeDataTableOnEach() {\n  var dataTableSelector = $('.data-table');\n  if (dataTableSelector.length) {\n    dataTableSelector.each(function(n, el) {\n      var options = {};\n      if (!el.classList.contains('dataTable')) {\n        if (el.dataset.checkboxTable == 'true') {\n          options = {\n            columnDefs: [{\n              \"targets\": 0,\n              \"orderable\": false\n            }],\n          };\n        }\n        //console.log('DataTables added on: #' + el.id);\n        $(el).DataTable(options);\n      }\n    });\n  }\n}\nmodule.exports = makeDataTableOnEach;\n\n},{}],9:[function(require,module,exports){\nfunction makeSelectizeOnEach() {\n  var selectizeSelector = $('[data-selectize]');\n  var options = {\n    maxItems: 1,\n    plugins: ['remove_button', 'restore_on_backspace'],\n    persist: false,\n  };\n  if (selectizeSelector.length) {\n    selectizeSelector.each(function(n, el) {\n\n      if (!el.selectize) {\n        if(el.multiple) {\n          options.maxItems = 99;\n\n          Object.assign(options, {\n            delimiter: ',,',\n            create: function(input) {\n              return {\n                value: input,\n                text: input\n              }\n            }\n          });\n\n        }\n        $(el).selectize(options);\n      }\n    });\n  }\n}\n\nmodule.exports = makeSelectizeOnEach;\n\n},{}],10:[function(require,module,exports){\nmodule.exports = {\n  responsive: true,\n  order: [],\n  language: {\n    \"sEmptyTable\": \"Nenhum registro encontrado\",\n    \"sInfo\": \"Mostrando de _START_ até _END_ de _TOTAL_ registros\",\n    \"sInfoEmpty\": \"Mostrando 0 até 0 de 0 registros\",\n    \"sInfoFiltered\": \"(Filtrados de _MAX_ registros)\",\n    \"sInfoPostFix\": \"\",\n    \"sInfoThousands\": \".\",\n    \"sLengthMenu\": \"Mostrar _MENU_ resultados\",\n    \"sLoadingRecords\": \"Carregando...\",\n    \"sProcessing\": \"Processando...\",\n    \"sZeroRecords\": \"Nenhum registro encontrado\",\n    \"sSearch\": \"Pesquisar: \",\n    \"oPaginate\": {\n      \"sNext\": \"Próximo\",\n      \"sPrevious\": \"Anterior\",\n      \"sFirst\": \"Primeiro\",\n      \"sLast\": \"Último\"\n    },\n    \"oAria\": {\n      \"sSortAscending\": \": Ordenar colunas de forma ascendente\",\n      \"sSortDescending\": \": Ordenar colunas de forma descendente\"\n    }\n  }\n};\n},{}]},{},[2]);\n"],"file":"app.min.js","sourceRoot":"/source/"}